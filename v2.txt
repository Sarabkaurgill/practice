code for version 2